

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ROS Package bob_moondream &mdash; Bob&#39;s Handbuch 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0603aa02" />

  
    <link rel="shortcut icon" href="../_static/profile_image-300x300.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ROS Package bob_moondream_msgs" href="bob-moondream-msgs.html" />
    <link rel="prev" title="ROS Package bob_llm" href="bob-llm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Bob's Handbuch
              <img src="../_static/bob_vv.gif" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Packages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bob-coquitts.html">ROS Package bob_coquitts</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-flux2.html">ROS Package bob_flux2</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-flux2k.html">ROS Package bob_flux2k</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-launch.html">ROS Package bob_launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-llm.html">ROS Package bob_llm</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ROS Package bob_moondream</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-loading">Model Loading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ros-2-dependencies">ROS 2 Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-dependencies">Python Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#build-instructions">Build Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#option-1-using-a-standard-camera-driver">Option 1: Using a Standard Camera Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="#option-2-using-the-provided-launch-file">Option 2: Using the Provided Launch File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#launching-the-node">Launching the Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#real-time-detection-and-pointing">Real-time Detection and Pointing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interactive-query-script">Interactive Query Script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-to-use">How to Use</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subscribers">Subscribers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#publishers">Publishers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#services">Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bob-moondream-msgs.html">ROS Package bob_moondream_msgs</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-msgs.html">ROS Package bob_msgs</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-sd35.html">ROS Package bob_sd35</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-topic-tools.html">ROS Package bob_topic_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="bob-vector-db.html">ROS Package bob_vector_db</a></li>
<li class="toctree-l1"><a class="reference internal" href="voskros.html">ROS Package VoskRos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OTHER</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="vox.html">Package VOX Real-time Transcription</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bob's Handbuch</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ROS Package bob_moondream</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/bob/bob-moondream.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ros-package-bob-moondream">
<h1>ROS Package <a class="reference external" href="https://github.com/bob-ros2/bob_moondream">bob_moondream</a><a class="headerlink" href="#ros-package-bob-moondream" title="Link to this heading"></a></h1>
<p>This ROS 2 package provides a node that serves as a wrapper for the <a class="reference external" href="https://huggingface.co/vikhyatk/moondream2"><code class="docutils literal notranslate"><span class="pre">vikhyatk/moondream2</span></code></a>, a small but powerful <strong>vision-language model (VLM)</strong>. The <code class="docutils literal notranslate"><span class="pre">bob_moondream</span></code> node subscribes to a raw image topic and exposes a flexible ROS 2 interface for various <strong>visual reasoning and perception tasks</strong>.</p>
<p>The node loads the model into memory upon startup and processes the latest received image when a service is called or a prompt is published on a topic. It can perform image captioning, answer visual questions, detect objects based on a text description, and locate the center point of an object based on a textual description. It can also publish detection results and an annotated video feed for visualization.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.linkedin.com/shareArticle?mini=true&amp;amp;url=https%3A%2F%2Fgithub.com%2Fbob-ros2%2Fbob_moondream&amp;amp;title=bob_moondream%3A%20A%20ROS%202%20wrapper%20for%20the%20Moondream2%20VLM&amp;amp;summary=This%20ROS%202%20package%20provides%20a%20flexible%20interface%20for%20the%20Moondream2%20Vision-Language%20Model%2C%20enabling%20visual%20reasoning%20and%20perception%20tasks%20for%20robotics%20applications.">Share on LinkedIn</a></p></li>
<li><p><a class="reference external" href="https://www.reddit.com/submit?url=https%3A%2F%2Fgithub.com%2Fbob-ros2%2Fbob_moondream&amp;amp;title=I%20created%20a%20ROS%202%20wrapper%20for%20the%20Moondream2%20Vision-Language%20Model">Share on Reddit</a></p></li>
<li><p><a class="reference external" href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fgithub.com%2Fbob-ros2%2Fbob_moondream&amp;amp;t=Show%20HN%3A%20A%20ROS%202%20wrapper%20for%20the%20Moondream2%20VLM">Share on Hacker News</a></p></li>
<li><p><a class="reference external" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fgithub.com%2Fbob-ros2%2Fbob_moondream&amp;amp;text=Check%20out%20bob_moondream%2C%20a%20ROS%202%20wrapper%20for%20the%20Moondream2%20Vision-Language%20Model!&amp;amp;hashtags=ROS%2CRobotics%2CAI%2CVLM%2CComputerVision">Share on X</a></p></li>
</ul>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p><img alt="Real-Time Diagram" src="https://github.com/bob-ros2/bob_moondream/blob/main/images/real_time.png?raw=true" />
<img alt="ROS Services" src="https://github.com/bob-ros2/bob_moondream/blob/main/images/services.png?raw=true" />
<img alt="String Topics" src="https://github.com/bob-ros2/bob_moondream/blob/main/images/string_topics.png?raw=true" /></p>
<section id="model-loading">
<h3>Model Loading<a class="headerlink" href="#model-loading" title="Link to this heading"></a></h3>
<p>On the <strong>first launch</strong>, the node will automatically download the model weights from the Hugging Face Hub and save them to a local cache directory. This process requires an internet connection and may take a few minutes depending on your network speed. The total download size is approximately <strong>3-4 GB</strong>.</p>
<p>The download location is determined by the <code class="docutils literal notranslate"><span class="pre">cache_dir</span></code> parameter, which defaults to a <code class="docutils literal notranslate"><span class="pre">models</span></code> folder inside the directory where the node is launched.</p>
<p>When loaded onto a GPU (the default behavior), the model consumes approximately <strong>4 GB of VRAM</strong>. Ensure your GPU has sufficient memory available.</p>
<p>Subsequent launches of the node will be much faster, as the model will be loaded directly from this local cache, allowing for offline operation after the initial download.</p>
</section>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h2>
<section id="ros-2-dependencies">
<h3>ROS 2 Dependencies<a class="headerlink" href="#ros-2-dependencies" title="Link to this heading"></a></h3>
<p>This package depends on several standard ROS 2 message packages and a custom message package. Ensure they are available in your ROS 2 workspace.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">std_msgs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sensor_msgs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vision_msgs</span></code></p></li>
<li><p><a class="reference external" href="https://github.com/bob-ros2/bob_moondream_msgs"><code class="docutils literal notranslate"><span class="pre">bob_moondream_msgs</span></code></a>: This custom service message package must be located and built within the same workspace as <code class="docutils literal notranslate"><span class="pre">bob_moondream</span></code>.</p></li>
</ul>
</section>
<section id="python-dependencies">
<h3>Python Dependencies<a class="headerlink" href="#python-dependencies" title="Link to this heading"></a></h3>
<p>It is highly recommended to use a Python virtual environment (<code class="docutils literal notranslate"><span class="pre">venv</span></code>) to manage these dependencies and avoid conflicts with other projects or system packages.</p>
<p>The node requires several Python packages to run the vision-language model. These are listed in <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> and can be installed using pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
<p>This will install key libraries such as <code class="docutils literal notranslate"><span class="pre">transformers</span></code>, <code class="docutils literal notranslate"><span class="pre">torch</span></code>, and <code class="docutils literal notranslate"><span class="pre">Pillow</span></code>.</p>
</section>
</section>
<section id="build-instructions">
<h2>Build Instructions<a class="headerlink" href="#build-instructions" title="Link to this heading"></a></h2>
<p>To build the <code class="docutils literal notranslate"><span class="pre">bob_moondream</span></code> package, follow these steps:</p>
<ol class="arabic">
<li><p><strong>Create a ROS 2 Workspace:</strong>
If you don’t have one already, create a new ROS 2 workspace.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>~/ros2_ws/src
<span class="nb">cd</span><span class="w"> </span>~/ros2_ws
</pre></div>
</div>
</li>
<li><p><strong>Clone the Repositories:</strong>
Clone this package and its message dependency into the <code class="docutils literal notranslate"><span class="pre">src</span></code> directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>src
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bob-ros2/bob_moondream.git
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bob-ros2/bob_moondream_msgs.git
</pre></div>
</div>
</li>
<li><p><strong>Install Python Dependencies:</strong>
Navigate to the <code class="docutils literal notranslate"><span class="pre">bob_moondream</span></code> package and install the required Python packages.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>bob_moondream
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
<span class="nb">cd</span><span class="w"> </span>../..<span class="w"> </span>
</pre></div>
</div>
</li>
<li><p><strong>Build the Workspace:</strong>
Use <code class="docutils literal notranslate"><span class="pre">colcon</span></code> to build the packages.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>colcon<span class="w"> </span>build
</pre></div>
</div>
</li>
<li><p><strong>Source the Workspace:</strong>
Before running any nodes, source your workspace’s setup file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>install/setup.bash
</pre></div>
</div>
</li>
</ol>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h3>
<p>Before launching the <code class="docutils literal notranslate"><span class="pre">moondream</span></code> node, ensure you have a source of images being published to the <code class="docutils literal notranslate"><span class="pre">image_input</span></code> topic. This can be from a real camera driver or a rosbag file.</p>
<section id="option-1-using-a-standard-camera-driver">
<h4>Option 1: Using a Standard Camera Driver<a class="headerlink" href="#option-1-using-a-standard-camera-driver" title="Link to this heading"></a></h4>
<p>For example, to run a USB camera node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># You may need to install a camera driver first</span>
<span class="c1"># sudo apt install ros-humble-usb-cam</span>

<span class="c1"># Launch the camera node and remap its output to image_input</span>
ros2<span class="w"> </span>run<span class="w"> </span>usb_cam<span class="w"> </span>usb_cam_node_exe<span class="w"> </span>--ros-args<span class="w"> </span>-r<span class="w"> </span>image_raw:<span class="o">=</span>image_input
</pre></div>
</div>
</section>
<section id="option-2-using-the-provided-launch-file">
<h4>Option 2: Using the Provided Launch File<a class="headerlink" href="#option-2-using-the-provided-launch-file" title="Link to this heading"></a></h4>
<p>This package includes a convenience launch file that starts a camera node and automatically handles the topic remapping for you. This launch file uses <code class="docutils literal notranslate"><span class="pre">topic_tools</span></code> to throttle the image stream for better performance. Ensure it is installed first:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># For ROS 2 Humble</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ros-humble-topic-tools
</pre></div>
</div>
<p>Once installed, you can run the launch file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>bob_moondream<span class="w"> </span>camera.launch.py
</pre></div>
</div>
</section>
</section>
<section id="launching-the-node">
<h3>Launching the Node<a class="headerlink" href="#launching-the-node" title="Link to this heading"></a></h3>
<p>Once your workspace is sourced and an image feed is active, open a new terminal and run the following command to start the node.</p>
<p><strong>Basic Launch with remapping:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>bob_moondream<span class="w"> </span>moondream<span class="w"> </span>--ros-args<span class="w"> </span>-r<span class="w"> </span>image_input:<span class="o">=</span>/camera/image_raw/throttled<span class="w"> </span>-r<span class="w"> </span>__ns:<span class="o">=</span>/vision
</pre></div>
</div>
<p>On the first run, this will trigger the model download, which can take several minutes.</p>
<p><strong>Launch on CPU:</strong>
To run the model on the CPU, use the <code class="docutils literal notranslate"><span class="pre">device</span></code> parameter:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>bob_moondream<span class="w"> </span>moondream<span class="w"> </span>--ros-args<span class="w"> </span>-p<span class="w"> </span>device:<span class="o">=</span>cpu
</pre></div>
</div>
<p>Once the node is running and has loaded the model, you can interact with it using the services or the interactive script.</p>
</section>
<section id="real-time-detection-and-pointing">
<h3>Real-time Detection and Pointing<a class="headerlink" href="#real-time-detection-and-pointing" title="Link to this heading"></a></h3>
<p>You can enable continuous detection or pointing on the live image stream by setting the <code class="docutils literal notranslate"><span class="pre">prompt_detect</span></code> and <code class="docutils literal notranslate"><span class="pre">prompt_point</span></code> parameters at runtime. The node will process every incoming image frame with the provided prompt.</p>
<p><strong>To start real-time object detection:</strong>
Open a new terminal and use the <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">param</span> <span class="pre">set</span></code> command to provide a detection prompt. For example, to continuously look for a cup:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>param<span class="w"> </span><span class="nb">set</span><span class="w"> </span>/moondream<span class="w"> </span>prompt_detect<span class="w"> </span><span class="s2">&quot;the cup&quot;</span>
</pre></div>
</div>
<p>The node will now publish bounding boxes to <code class="docutils literal notranslate"><span class="pre">/detected_objects</span></code> and the annotated video to <code class="docutils literal notranslate"><span class="pre">/annotated_image</span></code>.</p>
<p><strong>To start real-time pointing:</strong>
Similarly, you can ask the model to continuously point to a specific feature:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>param<span class="w"> </span><span class="nb">set</span><span class="w"> </span>/moondream<span class="w"> </span>prompt_point<span class="w"> </span><span class="s2">&quot;the tip of the pen&quot;</span>
</pre></div>
</div>
<p>The node will publish center points to <code class="docutils literal notranslate"><span class="pre">/pointed_objects</span></code>.</p>
<p><strong>To stop real-time processing:</strong>
To disable the continuous processing, simply set the parameter to an empty string:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>param<span class="w"> </span><span class="nb">set</span><span class="w"> </span>/moondream<span class="w"> </span>prompt_detect<span class="w"> </span><span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="interactive-query-script">
<h2>Interactive Query Script<a class="headerlink" href="#interactive-query-script" title="Link to this heading"></a></h2>
<p>The package includes a convenient helper script, <code class="docutils literal notranslate"><span class="pre">query.sh</span></code>, for interacting with the node’s topic-based interface directly from the command line. This script allows you to send prompts and see the results in real-time without needing to write a separate node.</p>
<section id="how-to-use">
<h3>How to Use<a class="headerlink" href="#how-to-use" title="Link to this heading"></a></h3>
<p>To use the script, run it with <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span></code> and specify the type of query you want to perform.</p>
<p><strong>Syntax:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>bob_moondream<span class="w"> </span>query.sh<span class="w"> </span>&lt;type&gt;<span class="w"> </span><span class="o">[</span>&lt;namespace&gt;<span class="o">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&lt;type&gt;</span></code></strong>: The mode of interaction. Must be one of <code class="docutils literal notranslate"><span class="pre">visual_query</span></code>, <code class="docutils literal notranslate"><span class="pre">object_detection</span></code>, or <code class="docutils literal notranslate"><span class="pre">pointing</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">[&lt;namespace&gt;]</span></code></strong>: (Optional) The ROS 2 namespace where the topics are located. Defaults to <code class="docutils literal notranslate"><span class="pre">/vision</span></code>.</p></li>
</ul>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h3>
<p>To start a visual query session, launch the <code class="docutils literal notranslate"><span class="pre">moondream_node</span></code> and a camera feed. Then, in a new terminal, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ros2<span class="w"> </span>run<span class="w"> </span>bob_moondream<span class="w"> </span>query.sh<span class="w"> </span>visual_query
---<span class="w"> </span>Listening<span class="w"> </span><span class="k">for</span><span class="w"> </span>results<span class="w"> </span>on<span class="w"> </span>/vision/visual_query_result
---<span class="w"> </span>Enter<span class="w"> </span>your<span class="w"> </span>prompt<span class="w"> </span>below<span class="w"> </span><span class="o">(</span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span><span class="nb">exit</span><span class="o">)</span>
&gt;<span class="w"> </span>what<span class="w"> </span><span class="k">do</span><span class="w"> </span>you<span class="w"> </span>see
<span class="s2">&quot;A man is sitting at a desk, working on a computer. He is focused on his task...&quot;</span>
&gt;
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ros2<span class="w"> </span>run<span class="w"> </span>bob_moondream<span class="w"> </span>query.sh<span class="w"> </span>object_detection
---<span class="w"> </span>Listening<span class="w"> </span><span class="k">for</span><span class="w"> </span>results<span class="w"> </span>on<span class="w"> </span>/vision/object_detection_result
---<span class="w"> </span>Enter<span class="w"> </span>your<span class="w"> </span>prompt<span class="w"> </span>below<span class="w"> </span><span class="o">(</span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span><span class="nb">exit</span><span class="o">)</span>
&gt;<span class="w"> </span>mark<span class="w"> </span>the<span class="w"> </span>cups
<span class="s1">&#39;[{&quot;x_min&quot;: 0.19673718698322773, &quot;y_min&quot;: 0.6845761351287365, &quot;x_max&quot;: 0.25443468801677227, &quot;y_max&quot;: 0.8037051148712635}, {&quot;x_min&quot;: 0.3479478508234024, &quot;y_min&quot;: 0.6667342223227024, &quot;x_max&quot;: 0.4118177741765976, &quot;y_max&quot;: 0.7707657776772976}&#39;</span>
&gt;
</pre></div>
</div>
</section>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">model_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;vikhyatk/moondream2&quot;</span></code></p></td>
<td><p>The name of the model on the Hugging Face Hub.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">model_revision</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;2025-05-20&quot;</span></code></p></td>
<td><p>The specific model revision (git commit hash or tag) to use.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cache_dir</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;./models&quot;</span></code></p></td>
<td><p>The local directory where the model will be downloaded and cached.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">frame_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;moondream&quot;</span></code></p></td>
<td><p>The frame ID to be used in the headers of published messages.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;cuda&quot;</span></code></p></td>
<td><p>The device to run the model on (e.g., “cuda” for GPU, “cpu” for CPU).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">prompt_point</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p>If set, continuously runs pointing detection on every new image frame.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">prompt_detect</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p></td>
<td><p>If set, continuously runs object detection on every new image frame.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="subscribers">
<h2>Subscribers<a class="headerlink" href="#subscribers" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Topic</p></th>
<th class="head"><p>Message Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">image_input</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sensor_msgs/msg/Image</span></code></p></td>
<td><p>The main input topic for raw images that will be processed by the model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">visual_query_prompt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">std_msgs/msg/String</span></code></p></td>
<td><p>Receives a text prompt to ask a question. The answer is published on <code class="docutils literal notranslate"><span class="pre">visual_query_result</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">object_detection_prompt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">std_msgs/msg/String</span></code></p></td>
<td><p>Receives a text prompt to detect an object. The result is published on <code class="docutils literal notranslate"><span class="pre">object_detection_result</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pointing_prompt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">std_msgs/msg/String</span></code></p></td>
<td><p>Receives a text prompt to find a point. The result is published on <code class="docutils literal notranslate"><span class="pre">pointing_result</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="publishers">
<h2>Publishers<a class="headerlink" href="#publishers" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Topic</p></th>
<th class="head"><p>Message Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">detected_objects</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vision_msgs/msg/Detection2DArray</span></code></p></td>
<td><p>Publishes bounding boxes of detected objects.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pointed_objects</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vision_msgs/msg/Detection2DArray</span></code></p></td>
<td><p>Publishes points of interest (as zero-size bounding boxes).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">annotated_image</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sensor_msgs/msg/Image</span></code></p></td>
<td><p>Publishes the input image with detections drawn on it.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">visual_query_result</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">std_msgs/msg/String</span></code></p></td>
<td><p>Publishes the text answer from a visual query.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">object_detection_result</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">std_msgs/msg/String</span></code></p></td>
<td><p>Publishes object detection results as a JSON string.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pointing_result</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">std_msgs/msg/String</span></code></p></td>
<td><p>Publishes pointing results as a JSON string.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="services">
<h2>Services<a class="headerlink" href="#services" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Service Name</p></th>
<th class="head"><p>Service Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">caption</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bob_moondream_msgs/srv/VisualQuery</span></code></p></td>
<td><p>Generates a caption for the latest image. The <code class="docutils literal notranslate"><span class="pre">prompt</span></code> is ignored.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">visual_query</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bob_moondream_msgs/srv/VisualQuery</span></code></p></td>
<td><p>Asks a question (<code class="docutils literal notranslate"><span class="pre">prompt</span></code>) about the latest image.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">object_detection</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bob_moondream_msgs/srv/VisualQuery</span></code></p></td>
<td><p>Detects objects described by the <code class="docutils literal notranslate"><span class="pre">prompt</span></code>. Returns a JSON string.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pointing</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bob_moondream_msgs/srv/VisualQuery</span></code></p></td>
<td><p>Finds points of interest described by the <code class="docutils literal notranslate"><span class="pre">prompt</span></code>. Returns a JSON string.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bob-llm.html" class="btn btn-neutral float-left" title="ROS Package bob_llm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bob-moondream-msgs.html" class="btn btn-neutral float-right" title="ROS Package bob_moondream_msgs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright BobRos.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>